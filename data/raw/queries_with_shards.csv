query_id,query_text,execution_time_ms,status,documents_returned,timestamp
1,db.alerts.find({}),71,success,1000,2025-06-22T17:34:16Z
2,db.alerts.find({}).sort({ timestamp: -1 }).limit(100),22,success,100,2025-06-22T17:34:16Z
3,"db.houses.aggregate([{$match: {city: """"Cluj""""}}])",35,success,1000,2025-06-22T17:34:16Z
4,db.alerts.countDocuments({}),251,success,250000,2025-06-22T17:34:17Z
5,"db.appliances.distinct(""""type"""")",11,success,10,2025-06-22T17:34:17Z
6,db.houses.find().limit(10),7,success,10,2025-06-22T17:34:17Z
7,"db.contracts.find({ """"supplier_id"""": 10 })",42,success,1000,2025-06-22T17:34:17Z
8,"db.weather_conditions.find({location: """"Cluj""""}).limit(5)",5,success,5,2025-06-22T17:34:17Z
9,db.users.aggregate([{ $sample: { size: 1 }}]),87,success,1000,2025-06-22T17:34:17Z
10,db.appliances.countDocuments({}),6,success,100,2025-06-22T17:34:17Z
11,db.houses.find({built_year: { $gt: 2010 }}),33,success,1000,2025-06-22T17:34:17Z
12,"db.houses.aggregate([{ $match: { built_year: { $gt: 2015 } } }, { $sort: { area_sqm: -1 } }])",36,success,1000,2025-06-22T17:34:17Z
13,"db.appliances.aggregate([{ $project: { name: 1, brand: 1, _id: 0 }}])",8,success,100,2025-06-22T17:34:17Z
14,"db.houses.aggregate([{ $sort: { area_sqm: -1 }},{ $limit: 5 }])",33,success,1000,2025-06-22T17:34:17Z
15,"db.users.aggregate([{ $match: { birthdate: { $gt: ISODate(""""1990-01-01T00:00:00Z"""") } } }, { $project: { name: 1, email: 1 } }])",43,success,1000,2025-06-22T17:34:17Z
16,"db.contracts.aggregate([{ $sort: { supplier_id: 1 }},{ $limit: 5 }])",43,success,1000,2025-06-22T17:34:17Z
17,"db.energy_readings.aggregate([{ $match: { generation_kwh: { $gt: 2.0 }}},{ $limit: 10 }])",105,success,1000,2025-06-22T17:34:17Z
18,"db.houses.aggregate([{ $group: { _id: """"$city"""" } }, { $limit: 5 }])",34,success,1000,2025-06-22T17:34:17Z
19,"db.energy_readings.aggregate([{ $project: { total_use_kwh: 1, timestamp: 1 }},{ $limit: 5 }])",88,success,1000,2025-06-22T17:34:17Z
20,"db.alerts.aggregate([{ $match: { value: { $gt: 6 }}},{ $sort: { value: -1 }},{ $limit: 5 }])",52,success,1000,2025-06-22T17:34:17Z
21,"db.energy_readings.aggregate([{ $match: { total_use_kwh: { $gte: 1, $lte: 2 }}},{ $limit: 10 }])",91,success,1000,2025-06-22T17:34:17Z
22,"db.energy_readings.aggregate([{ $group: { _id: """"$house_id"""", total_use: { $sum: """"$total_use_kwh"""" } } }])",85,success,1000,2025-06-22T17:34:18Z
23,"db.weather_conditions.aggregate([{ $group: { _id: { location: """"$location"""", day: { $dayOfYear: """"$timestamp"""" } }, avg_temp: { $avg: """"$temperature_celsius"""" } } }])",41,success,1000,2025-06-22T17:34:18Z
24,"db.energy_readings.aggregate([{ $lookup: { from: """"houses"""", localField: """"house_id"""", foreignField: """"_id"""", as: """"house_info"""" } }, { $limit: 10 }])",81,success,1000,2025-06-22T17:34:18Z
25,"db.contracts.aggregate([{ $group: { _id: """"$supplier_id"""", count: { $sum: 1 } } }])",44,success,1000,2025-06-22T17:34:18Z
26,"db.maintenance_logs.aggregate([{ $group: { _id: """"$appliance_id"""", total_cost: { $sum: """"$cost"""" } } }])",40,success,1000,2025-06-22T17:34:18Z
27,"db.energy_readings.aggregate([{ $setWindowFields: { partitionBy: """"$house_id"""", sortBy: { timestamp: 1 }, output: { delta: { $derivative: { input: """"$total_use_kwh"""", unit: """"hour"""" }, window: { docum...",89,success,1000,2025-06-22T17:34:18Z
28,"db.alerts.aggregate([{$lookup: { from: """"houses"""", localField: """"house_id"""", foreignField: """"_id"""", as: """"house_info""""}},{ $sort: { value: -1 }},{ $limit: 10 }])",52,success,1000,2025-06-22T17:34:18Z
29,"db.energy_readings.aggregate([{ $group: { _id: { month: { $month: """"$timestamp"""" } }, total_usage: { $sum: """"$total_use_kwh"""" } } }])",100,success,1000,2025-06-22T17:34:18Z
30,"db.energy_readings.aggregate([{ $unwind: """"$appliance_usages"""" }, { $group: { _id: """"$appliance_usages.appliance_id"""", total: { $sum: """"$appliance_usages.usage_kwh"""" } } }, { $sort: { total: -1 } }, {...",95,success,1000,2025-06-22T17:34:18Z
31,"db.energy_readings.aggregate([ { $unwind: """"$appliance_usages"""" },{ $group: {_id: """"$appliance_usages.appliance_id"""", total:{ $sum: """"$appliance_usages.usage_kwh"""" }}},{ $sort: { total: -1 } },{ $limi...",96,success,1000,2025-06-22T17:34:18Z
32,"db.energy_readings.aggregate([{$lookup:{from:""""contracts"""",localField:""""contract_id"""",foreignField:""""id"""",as:""""contract_info""""}},{$unwind:""""$contract_info""""},{$group:{_id:""""$contract_info.tariff_id"""",...",96,success,1000,2025-06-22T17:34:18Z
33,"db.weather_conditions.aggregate([{ $bucket: { groupBy: """"$temperature_celsius"""", boundaries: [0, 10, 20, 30, 40], default: """"out_of_range"""", output: { count: { $sum: 1 }, avg_humidity: { $avg: """"$humi...",46,success,1000,2025-06-22T17:34:18Z
34,"db.users.aggregate([{$lookup:{from:""""houses"""",localField:""""_id"""",foreignField:""""owner_id"""",as:""""houses""""}},{$project:{name:1,email:1,houses:1}},{$limit:10}])",45,success,1000,2025-06-22T17:34:18Z
35,"db.appliances.aggregate([{$lookup:{from:""""maintenance_logs"""",localField:""""id"""",foreignField:""""appliance_id"""",as:""""logs""""}},{$unwind:{path:""""$logs"""",preserveNullAndEmptyArrays:true}},{$group:{_id:""""$id...",10,success,100,2025-06-22T17:34:18Z
36,"db.energy_readings.aggregate([{$facet:{top_usage:[{$sort:{total_use_kwh:-1}},{$limit:5}],low_generation:[{$match:{generation_kwh:{$lt:0.5}}},{$count:""""count""""}]}}])",96,success,1000,2025-06-22T17:34:18Z
37,"db.energy_readings.aggregate([{ $unwind: """"$appliance_usages"""" }, { $lookup: { from: """"appliances"""", localField: """"appliance_usages.appliance_id"""", foreignField: """"id"""", as: """"appliance_info"""" } }, { ...",86,success,1000,2025-06-22T17:34:19Z
38,"db.houses.aggregate([{$lookup:{from:""""contracts"""",localField:""""id"""",foreignField:""""house_id"""",as:""""contracts""""}},{$unwind:""""$contracts""""},{$lookup:{from:""""tariffs"""",localField:""""contracts.tariff_id"""",...",39,success,1000,2025-06-22T17:34:19Z
39,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{rolling_avg:{$avg:""""$total_use_kwh"""",window:{range:[-2,0],unit:""""day""""}}}}},{$limit:10}])",83,success,1000,2025-06-22T17:34:19Z
40,"db.houses.aggregate([{$graphLookup:{from:""""houses"""",startWith:""""$city"""",connectFromField:""""city"""",connectToField:""""city"""",as:""""connected_houses""""}},{$limit:5}])",36,success,1000,2025-06-22T17:34:19Z
41,"db.energy_readings.aggregate([{$densify:{field:""""timestamp"""",range:{step:1,unit:""""hour"""",bounds:""""full""""}}},{$sort:{timestamp:1}},{$fill:{sortBy:{timestamp:1},output:{total_use_kwh:{method:""""linear""""}...",85,success,1000,2025-06-22T17:34:19Z
42,"db.energy_readings.aggregate([{$group:{_id:{month:{$dateTrunc:{date:""""$timestamp"""",unit:""""month""""}}},gen_total:{$sum:""""$generation_kwh""""}}}])",86,success,1000,2025-06-22T17:34:19Z
43,"db.tariffs.aggregate([{$graphLookup:{from:""""tariffs"""",startWith:""""$billing_model"""",connectFromField:""""billing_model"""",connectToField:""""billing_model"""",as:""""related_tariffs""""}},{$limit:10}])",13,success,20,2025-06-22T17:34:19Z
44,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",total:{$sum:""""$total_use_kwh""""}}},{$sort:{total:-1}},{$limit:5},{$project:{id:""""$_id"""",total:1,_id:0}}])",87,success,1000,2025-06-22T17:34:19Z
45,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{prev:{$shift:{output:""""$total_use_kwh"""",by:-1}},delta:{$derivative:{input:""""$total_use_kwh"""",uni...",84,success,1000,2025-06-22T17:34:19Z
46,"db.alerts.aggregate([{ $lookup: { from: """"weather_conditions"""", let: { alert_ts: """"$timestamp"""" }, pipeline: [ { $match: { $expr: { $and: [ { $gte: [""""$timestamp"""", { $subtract: [""""$$alert_ts"""", 1000 ...",52,success,1000,2025-06-22T17:34:19Z
47,"db.energy_readings.aggregate([{$match:{timestamp:{$gte:ISODate(""""2022-04-01T00:00:00Z""""),$lt:ISODate(""""2025-05-01T00:00:00Z"""")},total_use_kwh:{$exists:true,$ne:null},house_id:{$exists:true,$ne:null}}}...",82,success,1000,2025-06-22T17:34:19Z
48,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{variation:{$derivative:{input:""""$total_use_kwh"""",unit:""""day""""},window:{documents:[-1,0]}}}}},{$g...",82,success,1000,2025-06-22T17:34:19Z
49,"db.energy_readings.aggregate([{$unwind:""""$appliance_usages""""},{$group:{_id:{house_id:""""$house_id"""",appliance_id:""""$appliance_usages.appliance_id""""},appliance_total:{$sum:""""$appliance_usages.usage_kwh""...",84,success,1000,2025-06-22T17:34:19Z
50,"db.energy_readings.aggregate([{$lookup:{from:""""weather_conditions"""",localField:""""weather_id"""",foreignField:""""id"""",as:""""weather""""}},{$unwind:""""$weather""""},{$match:{total_use_kwh:{$gt:6},""""weather.tempe...",83,success,1000,2025-06-22T17:34:19Z
51,"db.energy_readings.aggregate([{ $lookup: { from: """"weather_conditions"""", let: { wid: """"$weather_id"""" }, pipeline: [ { $match: { $expr: { $eq: [""""$id"""", """"$$wid""""] } } } ], as: """"weather"""" } }, { $matc...",86,success,1000,2025-06-22T17:34:20Z
52,"db.energy_readings.aggregate([{$match:{timestamp:{$gte:ISODate(""""2023-04-01T00:00:00Z""""),$lt:ISODate(""""2025-05-01T00:00:00Z"""")},total_use_kwh:{$gt:7}}},{$group:{_id:""""$house_id"""",high_events:{$sum:1},...",83,success,1000,2025-06-22T17:34:20Z
53,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",gen_total:{$sum:""""$generation_kwh""""},use_total:{$sum:""""$total_use_kwh""""}}},{$project:{efficiency_score:{$divide:[""""$gen_total"""",""""$use_total""""]...",86,success,1000,2025-06-22T17:34:20Z
54,"db.energy_readings.aggregate([{$match:{timestamp:{$exists:true},total_use_kwh:{$exists:true,$ne:null,$gt:0}}},{$addFields:{hour:{$hour:""""$timestamp""""}}},{$group:{_id:""""$house_id"""",total_evening:{$sum:...",126,success,1000,2025-06-22T17:34:20Z
55,"db.maintenance_logs.aggregate([{$group:{_id:""""$appliance_id"""",interventions:{$sum:1},total_cost:{$sum:""""$cost""""}}},{$sort:{interventions:-1}},{$limit:5}])",39,success,1000,2025-06-22T17:34:20Z
56,"db.maintenance_logs.aggregate([{$group:{_id:{appliance_id:""""$appliance_id"""",name:""""$name""""},total_cost:{$sum:""""$cost""""},count:{$sum:1}}},{$project:{_id:0,appliance_id:""""$_id.appliance_id"""",name:""""$_id...",40,success,1000,2025-06-22T17:34:20Z
57,"db.maintenance_logs.aggregate([{$match:{date:{$gte:ISODate(""""2024-01-01T00:00:00Z""""),$lt:ISODate(""""2025-01-01T00:00:00Z"""")}}},{$lookup:{from:""""appliances"""",localField:""""appliance_id"""",foreignField:""""i...",42,success,1000,2025-06-22T17:34:20Z
58,"db.energy_readings.aggregate([{$unwind:""""$appliance_usages""""},{$group:{_id:""""$appliance_usages.appliance_id"""",total_use:{$sum:""""$appliance_usages.usage_kwh""""}}},{$sort:{total_use:-1}},{$limit:5}])",86,success,1000,2025-06-22T17:34:20Z
59,"db.maintenance_logs.aggregate([{$group:{_id:""""$appliance_id"""",total_cost:{$sum:""""$cost""""}}},{$lookup:{from:""""energy_readings"""",pipeline:[{$unwind:""""$appliance_usages""""},{$match:{""""appliance_usages.app...",42,success,1000,2025-06-22T17:34:20Z
60,"db.energy_readings.aggregate([{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""_id"""",as:""""house""""}},{$unwind:""""$house""""},{$group:{_id:""""$house.city"""",total_use:{$sum:""""$total_use_kwh""""...",89,success,1000,2025-06-22T17:34:20Z
61,"db.energy_readings.aggregate([{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""_id"""",as:""""house""""}},{$unwind:""""$house""""},{$group:{_id:""""$house._id"""",total_use:{$sum:""""$total_use_kwh""""}...",101,success,1000,2025-06-22T17:34:20Z
62,"db.appliances.aggregate([{$match:{house_id:{$ne:null}}},{$group:{_id:""""$house_id"""",count:{$sum:1}}},{$sort:{count:-1}},{$limit:10}])",9,success,100,2025-06-22T17:34:20Z
63,"db.energy_readings.aggregate([{$unwind:""""$appliance_usages""""},{$group:{_id:{house_id:""""$house_id"""",appliance_id:""""$appliance_usages.appliance_id""""},usage_total:{$sum:""""$appliance_usages.usage_kwh""""}}}...",82,success,1000,2025-06-22T17:34:20Z
64,"db.houses.aggregate([{$bucket:{groupBy:""""$area_sqm"""",boundaries:[0,50,100,150,200,250],default:""""250+"""",output:{count:{$sum:1},avg_built_year:{$avg:""""$built_year""""}}}}])",36,success,1000,2025-06-22T17:34:20Z
65,"db.contracts.aggregate([{$lookup:{from:""""tariffs"""",localField:""""tariff_id"""",foreignField:""""id"""",as:""""tariff""""}},{$unwind:""""$tariff""""},{$group:{_id:""""$tariff.billing_model"""",house_count:{$sum:1}}}])",46,success,1000,2025-06-22T17:34:20Z
66,"db.contracts.aggregate([{$match:{start_date:{$gte:ISODate(""""2023-02-05T00:00:00Z"""")}}},{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""id"""",as:""""house""""}},{$unwind:""""$house""""},{$proje...",46,success,1000,2025-06-22T17:34:21Z
67,"db.energy_readings.aggregate([{$lookup:{from:""""contracts"""",localField:""""contract_id"""",foreignField:""""_id"""",as:""""contract""""}},{$unwind:""""$contract""""},{$group:{_id:""""$contract.tariff_id"""",total_use:{$su...",87,success,1000,2025-06-22T17:34:21Z
68,"db.contracts.aggregate([{$group:{_id:""""$supplier_id"""",house_count:{$sum:1}}},{$match:{house_count:{$gt:3}}}])",49,success,1000,2025-06-22T17:34:21Z
69,"db.energy_readings.aggregate([{$lookup:{from:""""weather_conditions"""",localField:""""weather_id"""",foreignField:""""_id"""",as:""""weather""""}},{$unwind:""""$weather""""},{$bucket:{groupBy:""""$weather.temperature_cels...",111,success,1000,2025-06-22T17:34:21Z
70,"db.energy_readings.aggregate([{$lookup:{from:""""weather_conditions"""",localField:""""weather_id"""",foreignField:""""id"""",as:""""weather""""}},{$unwind:""""$weather""""},{$match:{""""weather.temperature_celsius"""":{$lt:...",86,success,1000,2025-06-22T17:34:21Z
71,"db.energy_readings.aggregate([{$lookup:{from:""""weather_conditions"""",localField:""""weather_id"""",foreignField:""""_id"""",as:""""weather""""}},{$unwind:""""$weather""""},{$match:{""""weather.temperature_celsius"""":{$gt...",83,success,1000,2025-06-22T17:34:21Z
72,"db.houses.aggregate([{$group:{_id:""""$user_id"""",house_count:{$sum:1}}},{$match:{house_count:{$gt:1}}},{$lookup:{from:""""users"""",localField:""""_id"""",foreignField:""""id"""",as:""""user_info""""}},{$unwind:""""$user...",38,success,1000,2025-06-22T17:34:21Z
73,"db.energy_readings.aggregate([{$addFields:{hour:{$hour:""""$timestamp""""}}},{$match:{$or:[{hour:{$gte:22}},{hour:{$lt:6}}]}},{$group:{_id:""""$house_id"""",night_use:{$sum:""""$total_use_kwh""""}}},{$sort:{night...",85,success,1000,2025-06-22T17:34:21Z
74,"db.energy_readings.aggregate([{$group:{_id:{house_id:""""$house_id"""",month:{$dateTrunc:{date:""""$timestamp"""",unit:""""month""""}}},total_use:{$sum:""""$total_use_kwh""""}}},{$sort:{""""_id.house_id"""":1,""""_id.month...",86,success,1000,2025-06-22T17:34:21Z
75,"db.energy_readings.aggregate([{$lookup:{from:""""weather_conditions"""",localField:""""weather_id"""",foreignField:""""id"""",as:""""weather""""}},{$unwind:""""$weather""""},{$bucket:{groupBy:""""$weather.temperature_celsi...",108,success,1000,2025-06-22T17:34:21Z
76,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{gen_diff:{$derivative:{input:""""$generation_kwh"""",unit:""""day""""},window:{documents:[-1,0]}}}}},{$m...",82,success,1000,2025-06-22T17:34:21Z
77,"db.appliances.aggregate([{$lookup:{from:""""maintenance_logs"""",localField:""""_id"""",foreignField:""""appliance_id"""",as:""""logs""""}},{$lookup:{from:""""energy_readings"""",pipeline:[{$unwind:""""$appliance_usages""""}...",9,success,100,2025-06-22T17:34:21Z
78,"db.appliances.aggregate([{$lookup:{from:""""maintenance_logs"""",localField:""""id"""",foreignField:""""appliance_id"""",as:""""logs""""}},{$addFields:{total_cost:{$reduce:{input:""""$logs"""",initialValue:0,in:{$add:[""""...",9,success,100,2025-06-22T17:34:21Z
79,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",gen:{$sum:""""$generation_kwh""""},use:{$sum:""""$total_use_kwh""""}}},{$project:{house_id:""""$_id"""",efficiency:{$cond:[{$eq:[""""$use"""",0]},0,{$divide:[""...",91,success,1000,2025-06-22T17:34:21Z
80,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{gen_diff:{$derivative:{input:""""$generation_kwh"""",unit:""""day""""},window:{documents:[-1,0]}},use_st...",115,success,1000,2025-06-22T17:34:22Z
81,"db.energy_readings.aggregate([{ $group: { _id: """"$house_id"""", total_use: { $sum: """"$total_use_kwh"""" } } }, { $sort: { total_use: -1 } }])",115,success,1000,2025-06-22T17:34:22Z
82,"db.houses.aggregate([{ $lookup: { from: """"contracts"""", localField: """"id"""", foreignField: """"house_id"""", as: """"contract"""" } }, { $unwind: """"$contract"""" }, { $group: { _id: """"$contract.supplier_id"""", hou...",46,success,1000,2025-06-22T17:34:22Z
83,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",total_use:{$sum:""""$total_use_kwh""""},total_gen:{$sum:""""$generation_kwh""""}}},{$project:{total_use:1,total_gen:1,gen_to_use_ratio:{$cond:[{$gt:[""""...",127,success,1000,2025-06-22T17:34:22Z
84,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{avg_use:{$avg:""""$total_use_kwh""""}}}},{$match:{$expr:{$gt:[""""$total_use_kwh"""",{$multiply:[""""$avg_...",116,success,1000,2025-06-22T17:34:22Z
85,"db.energy_readings.aggregate([{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""_id"""",as:""""house""""}},{$unwind:""""$house""""},{$group:{_id:""""$house._id"""",built_year:{$first:""""$house.built_y...",101,success,1000,2025-06-22T17:34:22Z
86,"db.energy_readings.aggregate([{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""_id"""",as:""""house""""}},{$unwind:""""$house""""},{$group:{_id:""""$house.city"""",city_avg:{$avg:""""$total_use_kwh""""}...",87,success,1000,2025-06-22T17:34:22Z
87,"db.energy_readings.aggregate([{$unwind:""""$appliance_usages""""},{$group:{_id:""""$house_id"""",appliance_count:{$addToSet:""""$appliance_usages.appliance_id""""},total_gen:{$sum:""""$generation_kwh""""}}},{$project...",86,success,1000,2025-06-22T17:34:22Z
88,"db.energy_readings.aggregate([{$addFields:{hour:{$hour:""""$timestamp""""}}},{$group:{_id:""""$house_id"""",morning:{$sum:{$cond:[{$and:[{$gte:[""""$hour"""",6]},{$lt:[""""$hour"""",12]}]},""""$total_use_kwh"""",0]}},eve...",111,success,1000,2025-06-22T17:34:22Z
89,"db.maintenance_logs.aggregate([{$project:{appliance_id:1,quarter:{$ceil:{$divide:[{$month:""""$date""""},3]}},year:{$year:""""$date""""}}},{$group:{_id:{appliance_id:""""$appliance_id"""",year:""""$year"""",quarter:""...",41,success,1000,2025-06-22T17:34:22Z
90,"db.energy_readings.aggregate([{ $group: { _id: """"$house_id"""", total_use: { $sum: """"$total_use_kwh"""" }, total_gen: { $sum: """"$generation_kwh"""" } } }, { $project: { total_use: 1, total_gen: 1, ratio: { ...",88,success,1000,2025-06-22T17:34:23Z
91,"db.energy_readings.aggregate([{$addFields:{hour:{$hour:""""$timestamp""""}}},{$group:{_id:""""$hour"""",total_use:{$sum:""""$total_use_kwh""""}}},{$sort:{total_use:-1}},{$limit:3}])",83,success,1000,2025-06-22T17:34:23Z
92,"db.energy_readings.aggregate([{$sample:{size:100000}},{$lookup:{from:""""contracts"""",localField:""""contract_id"""",foreignField:""""id"""",as:""""contract""""}},{$unwind:""""$contract""""},{$group:{_id:""""$contract.tar...",81,success,1000,2025-06-22T17:34:23Z
93,"db.energy_readings.aggregate([{$addFields:{weekday:{$dayOfWeek:""""$timestamp""""}}},{$group:{_id:""""$weekday"""",avg_use:{$avg:""""$total_use_kwh""""}}},{$sort:{_id:1}}])",90,success,1000,2025-06-22T17:34:23Z
94,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",total_gen:{$sum:""""$generation_kwh""""},total_use:{$sum:""""$total_use_kwh""""}}},{$project:{solar_ratio:{$divide:[""""$total_gen"""",""""$total_use""""]}}},{...",105,success,1000,2025-06-22T17:34:23Z
95,"db.energy_readings.aggregate([{$group: {_id: null, min: {$min: """"$total_use_kwh""""}, max: {$max: """"$total_use_kwh""""}, avg: {$avg:""""$total_use_kwh""""}}}])",83,success,1000,2025-06-22T17:34:23Z
96,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",total:{$sum:""""$total_use_kwh""""}}},{$sort:{total:-1}},{$limit:5},{$project:{id:""""$_id"""",total:1,_id:0}},{$out:""""top_consumers""""}])",86,success,1000,2025-06-22T17:34:23Z
97,db.maintenance_logs.findOne({appliance_id: {$exists: true}}),6,success,1,2025-06-22T17:34:23Z
98,db.appliances.findOne({id: {$exists: true}}),7,success,1,2025-06-22T17:34:23Z
99,"db.maintenance_logs.findOne({date: {$gte: ISODate(""""2024-01-01T00:00:00Z""""), $lt: ISODate(""""2025-01-01T00:00:00Z"""")}})",5,success,1,2025-06-22T17:34:23Z
100,"db.energy_readings.aggregate([{ $match: { house_id: 1481, timestamp: { $gte: ISODate(""""2025-04-16T00:00:00Z"""") } } }, { $group: { _id: """"$house_id"""", total_consumption: { $sum: """"$total_use_kwh"""" } } ...",82,success,1000,2025-06-22T17:34:23Z
101,"db.energy_readings.aggregate([{ $match: { house_id: 1481, timestamp: { $gte: ISODate(""""2025-04-16T00:00:00Z"""") } } }, { $group: { _id: """"$house_id"""", total_consumption: { $sum: """"$total_use_kwh"""" } } ...",84,success,1000,2025-06-22T17:34:23Z
102,"db.maintenance_logs.aggregate([{ $match: { date: { $gte: ISODate(""""2024-01-01T00:00:00Z""""), $lt: ISODate(""""2025-01-01T00:00:00Z"""") } } }, { $lookup: { from: """"appliances"""", localField: """"appliance_id""...",41,success,1000,2025-06-22T17:34:23Z
103,"db.energy_readings.aggregate([{ $group: { _id: """"$contract_id"""", total_use: { $sum: """"$total_use_kwh"""" } } }, { $sort: { total_use: -1 } }])",82,success,1000,2025-06-22T17:34:23Z
104,"db.energy_readings.aggregate([{ $group: { _id: null, max_total_use: { $max: """"$total_use_kwh"""" }, max_total_gen: { $max: """"$generation_kwh"""" } } }])",82,success,1000,2025-06-22T17:34:23Z
105,"db.energy_readings.aggregate([{ $group: { _id: """"$house_id"""", total_use: { $sum: """"$total_use_kwh"""" } } }, { $match: { total_use: { $gt: 1000 } } }, { $sort: { total_use: -1 } }])",135,success,1000,2025-06-22T17:34:24Z
106,"db.energy_readings.aggregate([{ $unwind: """"$appliance_usages"""" }, { $group: { _id: """"$appliance_usages.appliance_id"""", total_usage: { $sum: """"$appliance_usages.usage_kwh"""" } } }, { $sort: { total_usag...",85,success,1000,2025-06-22T17:34:24Z
107,db.energy_readings.find({ total_use_kwh: { $gt: 6 } }).limit(100),14,success,100,2025-06-22T17:34:24Z
108,"db.energy_readings.aggregate([{$match:{timestamp:{$gte:ISODate(""""2023-01-01T00:00:00Z""""),$lt:ISODate(""""2025-01-01T00:00:00Z"""")}}},{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""_id""""...",81,success,1000,2025-06-22T17:34:24Z
109,"db.houses.aggregate([{$match:{built_year:{$gte:2010}}},{$lookup:{from:""""energy_readings"""",localField:""""_id"""",foreignField:""""house_id"""",as:""""readings""""}},{$project:{address:1,city:1,area_sqm:1,readings...",36,success,1000,2025-06-22T17:34:24Z
110,"db.appliances.aggregate([{$lookup:{from:""""maintenance_logs"""",localField:""""id"""",foreignField:""""appliance_id"""",as:""""maintenance""""}},{$lookup:{from:""""energy_readings"""",let:{app_id:""""$id""""},pipeline:[{$un...",9,success,100,2025-06-22T17:34:24Z
111,"db.energy_readings.aggregate([{$match:{timestamp:{$gte:ISODate(""""2023-01-01"""")}}},{$addFields:{hour:{$hour:""""$timestamp""""},day:{$dayOfWeek:""""$timestamp""""},month:{$month:""""$timestamp""""}}},{$facet:{hour...",82,success,1000,2025-06-22T17:34:24Z
112,"db.contracts.aggregate([{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""id"""",as:""""house""""}},{$unwind:""""$house""""},{$lookup:{from:""""tariffs"""",localField:""""tariff_id"""",foreignField:""""id""...",49,success,1000,2025-06-22T17:34:24Z
113,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{moving_avg:{$avg:""""$total_use_kwh"""",window:{documents:[-3,""""current""""]}},usage_change:{$derivati...",95,success,1000,2025-06-22T17:34:24Z
114,"db.energy_readings.aggregate([{match:{timestamp:{ gte :ISODate(""""2023-01-01""""),$lt:ISODate(""""2024-01-01"""")}}},{lookup:{from:""""weather_conditions"""",localField:""""weather_id"""",foreignField:""""_id"""",as:""""w...",91,success,1000,2025-06-22T17:34:24Z
115,"db.houses.aggregate([{lookup:{from:""""users"""",localField:""""owner_id"""",foreignField:""""_id"""",as:""""owner""""}},{ unwind:""""owner""""},{ lookup:{from:""""energy_readings"""",localField:""""_id"""",foreignField:""""house_...",37,success,1000,2025-06-22T17:34:24Z
116,"db.contracts.aggregate([{match:{start_date:{ lte :ISODate(""""2023-01-01"""")}}},{lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""_id"""",as:""""house""""}},{ unwind:""""house""""},{ lookup:{from:""""t...",49,success,1000,2025-06-22T17:34:24Z
117,"db.appliances.aggregate([{match:{type:{ in:[""""refrigerator"""",""""hvac"""",""""water_heater"""",""""washing_machine""""]}}},{lookup:{from:""""maintenance_logs"""",localField:""""id"""",foreignField:""""appliance_id"""",as:""""m...",11,success,100,2025-06-22T17:34:24Z
118,"db.energy_readings.aggregate([{$match:{timestamp:{$gte:ISODate(""""2023-01-01""""),$lt:ISODate(""""2024-01-01"""")}}},{$lookup:{from:""""weather_conditions"""",localField:""""weather_id"""",foreignField:""""_id"""",as:""""...",84,success,1000,2025-06-22T17:34:24Z
119,"db.houses.aggregate([{$lookup:{from:""""users"""",localField:""""user_id"""",foreignField:""""_id"""",as:""""owner""""}},{$unwind:""""$owner""""},{$lookup:{from:""""energy_readings"""",localField:""""_id"""",foreignField:""""house...",37,success,1000,2025-06-22T17:34:24Z
120,"db.contracts.aggregate([{$match:{start_date:{$lte:ISODate(""""2023-01-01"""")}}},{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""_id"""",as:""""house""""}},{$unwind:""""$house""""},{$lookup:{from:""...",47,success,1000,2025-06-22T17:34:24Z
121,"db.appliances.aggregate([{$match:{type:{$in:[""""refrigerator"""",""""hvac"""",""""water_heater"""",""""washing_machine""""]}}},{$lookup:{from:""""maintenance_logs"""",localField:""""id"""",foreignField:""""appliance_id"""",as:""...",14,success,100,2025-06-22T17:34:24Z
122,"db.energy_readings.aggregate([{$match:{timestamp:{$gte:ISODate(""""2023-09-01"""")}}},{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{daily_avg:{$avg:""""$total_use_kwh"""",window:{r...",92,success,1000,2025-06-22T17:34:25Z
