query_id,index_status,query_text,execution_time_ms,status,documents_returned,error_message,timestamp
1,with_index,db.alerts.find({}),7597,success,250000,,2025-06-22T18:50:35Z
2,with_index,db.alerts.find({}).sort({timestamp:-1}).limit(100),13,success,100,,2025-06-22T18:50:43Z
3,with_index,"db.houses.aggregate([{$match:{city:""""Cluj""""}}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:43Z
4,with_index,db.alerts.countDocuments({}),211,success,250000,,2025-06-22T18:50:43Z
5,with_index,"db.appliances.distinct(""""type"""")",7,success,10,,2025-06-22T18:50:43Z
6,with_index,db.houses.find().limit(10),6,success,10,,2025-06-22T18:50:44Z
7,with_index,"db.contracts.find({""""supplier_id"""":10})",598,success,20000,,2025-06-22T18:50:44Z
8,with_index,"db.weather_conditions.find({location:""""Cluj""""}).limit(5)",8,success,5,,2025-06-22T18:50:45Z
9,with_index,db.users.aggregate([{$sample:{size:1}}]),43,success,1,,2025-06-22T18:50:45Z
10,with_index,db.appliances.countDocuments({}),5,success,100,,2025-06-22T18:50:45Z
11,with_index,db.houses.find({built_year:{$gt:2010}}),72,success,2788,,2025-06-22T18:50:45Z
12,with_index,"db.houses.aggregate([{$match:{built_year:{$gt:2015}}},{$sort:{area_sqm:-1}}])",60,success,1627,,2025-06-22T18:50:46Z
13,with_index,"db.appliances.aggregate([{$project:{name:1,brand:1,_id:0}}])",9,success,100,,2025-06-22T18:50:46Z
14,with_index,"db.houses.aggregate([{$sort:{area_sqm:-1}},{$limit:5}])",16,success,5,,2025-06-22T18:50:46Z
15,with_index,"db.users.aggregate([{$match:{birthdate:{$gt:ISODate(""""1990-01-01T00:00:00Z"""")",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:46Z
16,with_index,"db.contracts.aggregate([{$sort:{supplier_id:1}},{$limit:5}])",38,success,5,,2025-06-22T18:50:46Z
17,with_index,"db.energy_readings.aggregate([{$match:{generation_kwh:{$gt:2.0}}},{$limit:10}])",18,success,10,,2025-06-22T18:50:46Z
18,with_index,"db.houses.aggregate([{$group:{_id:""""$city""""}},{$limit:5}])",3,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:46Z
19,with_index,"db.energy_readings.aggregate([{$project:{total_use_kwh:1,timestamp:1}},{$limit:5}])",10,success,5,,2025-06-22T18:50:46Z
20,with_index,"db.alerts.aggregate([{$match:{value:{$gt:6}}},{$sort:{value:-1}},{$limit:5}])",206,success,5,,2025-06-22T18:50:47Z
21,with_index,"db.energy_readings.aggregate([{$match:{total_use_kwh:{$gte:1,$lte:2}}},{$limit:10}])",11,success,10,,2025-06-22T18:50:47Z
22,with_index,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",total_use:{$sum:""""$total_use_kwh""""}}}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:47Z
23,with_index,"db.weather_conditions.aggregate([{$group:{_id:{location:""""$location"""",day:{$dayOfYear:""""$timestamp""""}},avg_temp:{$avg:""""$temperature_celsius""""}}}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:47Z
24,with_index,"db.energy_readings.aggregate([{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""_id"""",as:""""house_info""""}},{$limit:10}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:47Z
25,with_index,"db.contracts.aggregate([{$group:{_id:""""$supplier_id"""",count:{$sum:1}}}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:47Z
26,with_index,"db.maintenance_logs.aggregate([{$group:{_id:""""$appliance_id"""",total_cost:{$sum:""""$cost""""}}}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:48Z
27,with_index,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{delta:{$derivative:{input:""""$total_use_kwh"""",unit:""""hour""""},window:{documents:[-1,0]}}}}},{$limi...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:48Z
28,with_index,"db.alerts.aggregate([{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""_id"""",as:""""house_info""""}},{$sort:{value:-1}},{$limit:10}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:48Z
29,with_index,"db.energy_readings.aggregate([{$group:{_id:{month:{$month:""""$timestamp""""}},total_usage:{$sum:""""$total_use_kwh""""}}}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:48Z
30,with_index,"db.energy_readings.aggregate([{$unwind:""""$appliance_usages""""},{$group:{_id:""""$appliance_usages.appliance_id"""",total:{$sum:""""$appliance_usages.usage_kwh""""}}},{$sort:{total:-1}},{$limit:5}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:48Z
31,with_index,"db.energy_readings.aggregate([{$unwind:""""$appliance_usages""""},{$group:{_id:""""$appliance_usages.appliance_id"""",total:{$sum:""""$appliance_usages.usage_kwh""""}}},{$sort:{total:-1}},{$limit:5}])",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:48Z
32,with_index,"db.energy_readings.aggregate([{$lookup:{from:""""contracts"""",localField:""""contract_id"""",foreignField:""""id"""",as:""""contract_info""""}},{$unwind:""""$contract_info""""},{$group:{_id:""""$contract_info.tariff_id"""",...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:48Z
33,with_index,"db.houses.aggregate([{$lookup:{from:""""contracts"""",localField:""""id"""",foreignField:""""house_id"""",as:""""contracte""""}},{$unwind:""""$contracte""""},{$lookup:{from:""""tariffs"""",localField:""""contracte.tariff_id"""",...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:48Z
34,with_index,"db.weather_conditions.aggregate([{$bucket:{groupBy:""""$temperature_celsius"""",boundaries:[0,10,20,30,40],default:""""out_of_range"""",output:{count:{$sum:1},avg_humidity:{$avg:""""$humidity""""}}}}])",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:48Z
35,with_index,"db.users.aggregate([{$lookup:{from:""""houses"""",localField:""""_id"""",foreignField:""""owner_id"""",as:""""houses""""}},{$project:{name:1,email:1,houses:1}},{$limit:10}])",3,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:49Z
36,with_index,"db.appliances.aggregate([{$lookup:{from:""""maintenance_logs"""",localField:""""id"""",foreignField:""""appliance_id"""",as:""""logs""""}},{$unwind:{path:""""$logs"""",preserveNullAndEmptyArrays:true}},{$group:{_id:""""$id...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:49Z
37,with_index,"db.energy_readings.aggregate([{$facet:{top_usage:[{$sort:{total_use_kwh:-1}},{$limit:5}],low_generation:[{$match:{generation_kwh:{$lt:0.5}}},{$count:""""count""""}]}}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:49Z
38,with_index,"db.energy_readings.aggregate([{$unwind:""""$appliance_usages""""},{$lookup:{from:""""appliances"""",localField:""""appliance_usages.appliance_id"""",foreignField:""""id"""",as:""""appliance_info""""}},{$unwind:""""$applian...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:49Z
39,with_index,"db.houses.aggregate([{$lookup:{from:""""contracts"""",localField:""""id"""",foreignField:""""house_id"""",as:""""contracts""""}},{$unwind:""""$contracts""""},{$lookup:{from:""""tariffs"""",localField:""""contracts.tariff_id"""",...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:49Z
40,with_index,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{rolling_avg:{$avg:""""$total_use_kwh"""",window:{range:[-2,0],unit:""""day""""}}}}},{$limit:10}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:49Z
41,with_index,"db.houses.aggregate([{$graphLookup:{from:""""houses"""",startWith:""""$city"""",connectFromField:""""city"""",connectToField:""""city"""",as:""""connected_houses""""}},{$limit:5}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:49Z
42,with_index,"db.energy_readings.aggregate([{$densify:{field:""""timestamp"""",range:{step:1,unit:""""hour"""",bounds:""""full""""}}},{$sort:{timestamp:1}},{$fill:{sortBy:{timestamp:1},output:{total_use_kwh:{method:""""linear""""}...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:49Z
43,with_index,"db.energy_readings.aggregate([{$group:{_id:{month:{$dateTrunc:{date:""""$timestamp"""",unit:""""month""""}}},gen_total:{$sum:""""$generation_kwh""""}}}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:49Z
44,with_index,"db.tariffs.aggregate([{$graphLookup:{from:""""tariffs"""",startWith:""""$billing_model"""",connectFromField:""""billing_model"""",connectToField:""""billing_model"""",as:""""related_tariffs""""}},{$limit:10}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:50Z
45,with_index,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",total:{$sum:""""$total_use_kwh""""}}},{$sort:{total:-1}},{$limit:5},{$project:{id:""""$_id"""",total:1,_id:0}}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:50Z
46,with_index,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{prev:{$shift:{output:""""$total_use_kwh"""",by:-1}},delta:{$derivative:{input:""""$total_use_kwh"""",uni...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:50Z
47,with_index,"db.alerts.aggregate([{$lookup:{from:""""weather_conditions"""",let:{alert_ts:""""$timestamp""""},pipeline:[{$match:{$expr:{$and:[{$gte:[""""$timestamp"""",{$subtract:[""""$$alert_ts"""",3600000]}]},{$lte:[""""$timestam...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:50Z
48,with_index,"db.energy_readings.aggregate([{$match:{timestamp:{$gte:ISODate(""""2022-04-01T00:00:00Z"""")",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:50Z
49,with_index,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{variation:{$derivative:{input:""""$total_use_kwh"""",unit:""""day""""},window:{documents:[-1,0]}}}}},{$g...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:50Z
50,with_index,"db.energy_readings.aggregate([{$unwind:""""$appliance_usages""""},{$group:{_id:{house_id:""""$house_id"""",appliance_id:""""$appliance_usages.appliance_id""""},appliance_total:{$sum:""""$appliance_usages.usage_kwh""...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:50Z
51,with_index,"db.energy_readings.aggregate([{$lookup:{from:""""weather_conditions"""",localField:""""weather_id"""",foreignField:""""id"""",as:""""weather""""}},{$unwind:""""$weather""""},{$match:{total_use_kwh:{$gt:6},""""weather.tempe...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:50Z
52,with_index,"db.energy_readings.aggregate([{$lookup:{from:""""weather_conditions"""",let:{wid:""""$weather_id""""},pipeline:[{$match:{$expr:{$eq:[""""$id"""",""""$$wid""""]}}}],as:""""weather""""}},{$match:{weather:{$ne:[]}}},{$proje...",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:50Z
53,with_index,"db.energy_readings.aggregate([{$match:{timestamp:{$gte:ISODate(""""2023-04-01T00:00:00Z"""")",9,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:51Z
54,with_index,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",gen_total:{$sum:""""$generation_kwh""""},use_total:{$sum:""""$total_use_kwh""""}}},{$project:{efficiency_score:{$divide:[""""$gen_total"""",""""$use_total""""]...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:51Z
55,with_index,"db.energy_readings.aggregate([{$match:{timestamp:{$exists:true},total_use_kwh:{$exists:true,$ne:null,$gt:0}}},{$addFields:{hour:{$hour:""""$timestamp""""}}},{$group:{_id:""""$house_id"""",total_evening:{$sum:...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:51Z
56,with_index,"db.maintenance_logs.aggregate([{$group:{_id:""""$appliance_id"""",interventions:{$sum:1},total_cost:{$sum:""""$cost""""}}},{$sort:{interventions:-1}},{$limit:5}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:51Z
57,with_index,"db.maintenance_logs.aggregate([{$group:{_id:{appliance_id:""""$appliance_id"""",name:""""$name""""},total_cost:{$sum:""""$cost""""},count:{$sum:1}}},{$project:{_id:0,appliance_id:""""$_id.appliance_id"""",name:""""$_id...",3,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:51Z
58,with_index,"db.maintenance_logs.aggregate([{$match:{date:{$gte:ISODate(""""2024-01-01T00:00:00Z"""")",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:51Z
59,with_index,"db.energy_readings.aggregate([{$unwind:""""$appliance_usages""""},{$group:{_id:""""$appliance_usages.appliance_id"""",total_use:{$sum:""""$appliance_usages.usage_kwh""""}}},{$sort:{total_use:-1}},{$limit:5}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:51Z
60,with_index,"db.maintenance_logs.aggregate([{$group:{_id:""""$appliance_id"""",total_cost:{$sum:""""$cost""""}}},{$lookup:{from:""""energy_readings"""",pipeline:[{$unwind:""""$appliance_usages""""},{$match:{""""appliance_usages.app...",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:51Z
61,with_index,"db.energy_readings.aggregate([{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""_id"""",as:""""house""""}},{$unwind:""""$house""""},{$group:{_id:""""$house.city"""",total_use:{$sum:""""$total_use_kwh""""...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:51Z
62,with_index,"db.energy_readings.aggregate([{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""_id"""",as:""""house""""}},{$unwind:""""$house""""},{$group:{_id:""""$house._id"""",total_use:{$sum:""""$total_use_kwh""""}...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:52Z
63,with_index,"db.appliances.aggregate([{$match:{house_id:{$ne:null}}},{$group:{_id:""""$house_id"""",count:{$sum:1}}},{$sort:{count:-1}},{$limit:10}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:52Z
64,with_index,"db.energy_readings.aggregate([{$unwind:""""$appliance_usages""""},{$group:{_id:{house_id:""""$house_id"""",appliance_id:""""$appliance_usages.appliance_id""""},usage_total:{$sum:""""$appliance_usages.usage_kwh""""}}}...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:52Z
65,with_index,"db.houses.aggregate([{$bucket:{groupBy:""""$area_sqm"""",boundaries:[0,50,100,150,200,250],default:""""250+"""",output:{count:{$sum:1},avg_built_year:{$avg:""""$built_year""""}}}}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:52Z
66,with_index,"db.contracts.aggregate([{$lookup:{from:""""tariffs"""",localField:""""tariff_id"""",foreignField:""""id"""",as:""""tariff""""}},{$unwind:""""$tariff""""},{$group:{_id:""""$tariff.billing_model"""",house_count:{$sum:1}}}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:52Z
67,with_index,"db.contracts.aggregate([{$match:{start_date:{$gte:ISODate(""""2023-02-05T00:00:00Z"""")",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:52Z
68,with_index,"db.energy_readings.aggregate([{$lookup:{from:""""contracts"""",localField:""""contract_id"""",foreignField:""""_id"""",as:""""contract""""}},{$unwind:""""$contract""""},{$group:{_id:""""$contract.tariff_id"""",total_use:{$su...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:52Z
69,with_index,"db.contracts.aggregate([{$group:{_id:""""$supplier_id"""",house_count:{$sum:1}}},{$match:{house_count:{$gt:3}}}])",3,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:52Z
70,with_index,"db.energy_readings.aggregate([{$lookup:{from:""""weather_conditions"""",localField:""""weather_id"""",foreignField:""""_id"""",as:""""weather""""}},{$unwind:""""$weather""""},{$bucket:{groupBy:""""$weather.temperature_cels...",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:52Z
71,with_index,"db.energy_readings.aggregate([{$lookup:{from:""""weather_conditions"""",localField:""""weather_id"""",foreignField:""""id"""",as:""""weather""""}},{$unwind:""""$weather""""},{$match:{""""weather.temperature_celsius"""":{$lt:...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:53Z
72,with_index,"db.energy_readings.aggregate([{$lookup:{from:""""weather_conditions"""",localField:""""weather_id"""",foreignField:""""_id"""",as:""""weather""""}},{$unwind:""""$weather""""},{$match:{""""weather.temperature_celsius"""":{$gt...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:53Z
73,with_index,"db.houses.aggregate([{$group:{_id:""""$user_id"""",house_count:{$sum:1}}},{$match:{house_count:{$gt:1}}},{$lookup:{from:""""users"""",localField:""""_id"""",foreignField:""""id"""",as:""""user_info""""}},{$unwind:""""$user...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:53Z
74,with_index,"db.energy_readings.aggregate([{$addFields:{hour:{$hour:""""$timestamp""""}}},{$match:{$or:[{hour:{$gte:22}},{hour:{$lt:6}}]}},{$group:{_id:""""$house_id"""",night_use:{$sum:""""$total_use_kwh""""}}},{$sort:{night...",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:53Z
75,with_index,"db.energy_readings.aggregate([{$group:{_id:{house_id:""""$house_id"""",month:{$dateTrunc:{date:""""$timestamp"""",unit:""""month""""}}},total_use:{$sum:""""$total_use_kwh""""}}},{$sort:{""""_id.house_id"""":1,""""_id.month...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:53Z
76,with_index,"db.energy_readings.aggregate([{$lookup:{from:""""weather_conditions"""",localField:""""weather_id"""",foreignField:""""id"""",as:""""weather""""}},{$unwind:""""$weather""""},{$bucket:{groupBy:""""$weather.temperature_celsi...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:53Z
77,with_index,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{gen_diff:{$derivative:{input:""""$generation_kwh"""",unit:""""day""""},window:{documents:[-1,0]}}}}},{$m...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:53Z
78,with_index,"db.appliances.aggregate([{$lookup:{from:""""maintenance_logs"""",localField:""""_id"""",foreignField:""""appliance_id"""",as:""""logs""""}},{$lookup:{from:""""energy_readings"""",pipeline:[{$unwind:""""$appliance_usages""""}...",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:53Z
79,with_index,"db.appliances.aggregate([{$lookup:{from:""""maintenance_logs"""",localField:""""id"""",foreignField:""""appliance_id"""",as:""""logs""""}},{$addFields:{total_cost:{$reduce:{input:""""$logs"""",initialValue:0,in:{$add:[""""...",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:53Z
80,with_index,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",gen:{$sum:""""$generation_kwh""""},use:{$sum:""""$total_use_kwh""""}}},{$project:{house_id:""""$_id"""",efficiency:{$cond:[{$eq:[""""$use"""",0]},0,{$divide:[""...",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:54Z
81,with_index,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{gen_diff:{$derivative:{input:""""$generation_kwh"""",unit:""""day""""},window:{documents:[-1,0]}},use_st...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:54Z
82,with_index,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",total_use:{$sum:""""$total_use_kwh""""}}},{$sort:{total_use:-1}}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:54Z
83,with_index,"db.houses.aggregate([{$lookup:{from:""""contracts"""",localField:""""id"""",foreignField:""""house_id"""",as:""""contract""""}},{$unwind:""""$contract""""},{$group:{_id:""""$contract.supplier_id"""",house_count:{$sum:1}}}])",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:54Z
84,with_index,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",total_use:{$sum:""""$total_use_kwh""""},total_gen:{$sum:""""$generation_kwh""""}}},{$project:{total_use:1,total_gen:1,gen_to_use_ratio:{$cond:[{$gt:[""""...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:54Z
85,with_index,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{avg_use:{$avg:""""$total_use_kwh""""}}}},{$match:{$expr:{$gt:[""""$total_use_kwh"""",{$multiply:[""""$avg_...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:54Z
86,with_index,"db.energy_readings.aggregate([{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""_id"""",as:""""house""""}},{$unwind:""""$house""""},{$group:{_id:""""$house._id"""",built_year:{$first:""""$house.built_y...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:54Z
87,with_index,"db.energy_readings.aggregate([{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""_id"""",as:""""house""""}},{$unwind:""""$house""""},{$group:{_id:""""$house.city"""",city_avg:{$avg:""""$total_use_kwh""""}...",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:54Z
88,with_index,"db.energy_readings.aggregate([{$unwind:""""$appliance_usages""""},{$group:{_id:""""$house_id"""",appliance_count:{$addToSet:""""$appliance_usages.appliance_id""""},total_gen:{$sum:""""$generation_kwh""""}}},{$project...",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:54Z
89,with_index,"db.energy_readings.aggregate([{$addFields:{hour:{$hour:""""$timestamp""""}}},{$group:{_id:""""$house_id"""",morning:{$sum:{$cond:[{$and:[{$gte:[""""$hour"""",6]},{$lt:[""""$hour"""",12]}]},""""$total_use_kwh"""",0]}},eve...",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:55Z
90,with_index,"db.maintenance_logs.aggregate([{$project:{appliance_id:1,quarter:{$ceil:{$divide:[{$month:""""$date""""},3]}},year:{$year:""""$date""""}}},{$group:{_id:{appliance_id:""""$appliance_id"""",year:""""$year"""",quarter:""...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:55Z
91,with_index,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",total_use:{$sum:""""$total_use_kwh""""},total_gen:{$sum:""""$generation_kwh""""}}},{$project:{total_use:1,total_gen:1,ratio:{$divide:[""""$total_use"""",""""...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:55Z
92,with_index,"db.energy_readings.aggregate([{$addFields:{hour:{$hour:""""$timestamp""""}}},{$group:{_id:""""$hour"""",total_use:{$sum:""""$total_use_kwh""""}}},{$sort:{total_use:-1}},{$limit:3}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:55Z
93,with_index,"db.energy_readings.aggregate([{$sample:{size:100000}},{$lookup:{from:""""contracts"""",localField:""""contract_id"""",foreignField:""""id"""",as:""""contract""""}},{$unwind:""""$contract""""},{$group:{_id:""""$contract.tar...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:55Z
94,with_index,"db.energy_readings.aggregate([{$addFields:{weekday:{$dayOfWeek:""""$timestamp""""}}},{$group:{_id:""""$weekday"""",avg_use:{$avg:""""$total_use_kwh""""}}},{$sort:{_id:1}}])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:55Z
95,with_index,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",total_gen:{$sum:""""$generation_kwh""""},total_use:{$sum:""""$total_use_kwh""""}}},{$project:{solar_ratio:{$divide:[""""$total_gen"""",""""$total_use""""]}}},{...",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:55Z
96,with_index,"db.energy_readings.aggregate([{$group:{_id:null,min:{$min:""""$total_use_kwh""""},max:{$max:""""$total_use_kwh""""},avg:{$avg:""""$total_use_kwh""""}}}])",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:55Z
97,with_index,"db.energy_readings.aggregate([{$group:{_id:""""$house_id"""",total:{$sum:""""$total_use_kwh""""}}},{$sort:{total:-1}},{$limit:5},{$project:{id:""""$_id"""",total:1,_id:0}},{$out:""""top_consumers""""}])",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:55Z
98,with_index,db.maintenance_logs.findOne({appliance_id:{$exists:true}}),9,success,1,,2025-06-22T18:50:55Z
99,with_index,db.appliances.findOne({id:{$exists:true}}),7,success,1,,2025-06-22T18:50:56Z
100,with_index,"db.maintenance_logs.findOne({date:{$gte:ISODate(""""2024-01-01T00:00:00Z"""")",8,success,1,,2025-06-22T18:50:56Z
101,with_index,"db.energy_readings.aggregate([{ $match: { house_id: 1481, timestamp: { $gte: ISODate(""""2025-04-16T00:00:00Z"""")",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:56Z
102,with_index,"db.energy_readings.aggregate([{ $match: { house_id: 1481, timestamp: { $gte: ISODate(""""2025-04-16T00:00:00Z"""")",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:56Z
103,with_index,"db.maintenance_logs.aggregate([{ $match: { date: { $gte: ISODate(""""2024-01-01T00:00:00Z"""")",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:56Z
104,with_index,"db.energy_readings.aggregate([{ $group: { _id: """"$contract_id"""", total_use: { $sum: """"$total_use_kwh"""" } } }, { $sort: { total_use: -1 } }])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:56Z
105,with_index,"db.energy_readings.aggregate([{ $group: { _id: null, max_total_use: { $max: """"$total_use_kwh"""" }, max_total_gen: { $max: """"$generation_kwh"""" } } }])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:56Z
106,with_index,"db.energy_readings.aggregate([{ $group: { _id: """"$house_id"""", total_use: { $sum: """"$total_use_kwh"""" } } }, { $match: { total_use: { $gt: 1000 } } }, { $sort: { total_use: -1 } }])",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:56Z
107,with_index,"db.energy_readings.aggregate([{ $unwind: """"$appliance_usages"""" }, { $group: { _id: """"$appliance_usages.appliance_id"""", total_usage: { $sum: """"$appliance_usages.usage_kwh"""" } } }, { $sort: { total_usag...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:57Z
108,with_index,db.energy_readings.find({ total_use_kwh: { $gt: 6 } }).limit(100),23,success,100,,2025-06-22T18:50:57Z
109,with_index,"db.energy_readings.aggregate([{$match:{timestamp:{$gte:ISODate(""""20230101T000000Z"""")",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:57Z
110,with_index,"db.houses.aggregate([{$match:{built_year:{$gte:2010}}},{$lookup:{from:""""energy_readings"""",localField:""""_id"""",foreignField:""""house_id"""",as:""""readings""""}},{$project:{address:1,city:1,area_sqm:1,readings...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:57Z
111,with_index,"db.appliances.aggregate([{$lookup:{from:""""maintenance_logs"""",localField:""""id"""",foreignField:""""appliance_id"""",as:""""maintenance""""}},{$lookup:{from:""""energy_readings"""",let:{app_id:""""$id""""},pipeline:[{$un...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:57Z
112,with_index,"db.energy_readings.aggregate([{$match:{timestamp:{$gte:ISODate(""""2023-01-01"""")",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:57Z
113,with_index,"db.contracts.aggregate([{$lookup:{from:""""houses"""",localField:""""house_id"""",foreignField:""""id"""",as:""""house""""}},{$unwind:""""$house""""},{$lookup:{from:""""tariffs"""",localField:""""tariff_id"""",foreignField:""""id""...",3,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:57Z
114,with_index,"db.energy_readings.aggregate([{$setWindowFields:{partitionBy:""""$house_id"""",sortBy:{timestamp:1},output:{moving_avg:{$avg:""""$total_use_kwh"""",window:{documents:[-3,""""current""""]}},usage_change:{$derivati...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:57Z
115,with_index,"db.energy_readings.aggregate([{match:{timestamp:{ gte :ISODate(""""2023-01-01"""")",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:57Z
116,with_index,"db.houses.aggregate([{lookup:{from:""""users"""",localField:""""owner_id"""",foreignField:""""_id"""",as:""""owner""""}},{ unwind:""""owner""""},{ lookup:{from:""""energy_readings"""",localField:""""_id"""",foreignField:""""house_...",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:58Z
117,with_index,"db.contracts.aggregate([{match:{start_date:{ lte :ISODate(""""2023-01-01"""")",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:58Z
118,with_index,"db.appliances.aggregate([{match:{type:{ in:[""""refrigerator"""",""""hvac"""",""""water_heater"""",""""washing_machine""""]}}},{lookup:{from:""""maintenance_logs"""",localField:""""id"""",foreignField:""""appliance_id"""",as:""""m...",5,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:58Z
119,with_index,"db.energy_readings.aggregate([{$match:{timestamp:{$gte:ISODate(""""2023-01-01"""")",3,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:58Z
120,with_index,"db.houses.aggregate([{$lookup:{from:""""users"""",localField:""""user_id"""",foreignField:""""_id"""",as:""""owner""""}},{$unwind:""""$owner""""},{$lookup:{from:""""energy_readings"""",localField:""""_id"""",foreignField:""""house...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:58Z
121,with_index,"db.contracts.aggregate([{$match:{start_date:{$lte:ISODate(""""2023-01-01"""")",3,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:58Z
122,with_index,"db.appliances.aggregate([{$match:{type:{$in:[""""refrigerator"""",""""hvac"""",""""water_heater"""",""""washing_machine""""]}}},{$lookup:{from:""""maintenance_logs"""",localField:""""id"""",foreignField:""""appliance_id"""",as:""...",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:58Z
123,with_index,"db.energy_readings.aggregate([{$match:{timestamp:{$gte:ISODate(""""2023-09-01"""")",4,error,0,Eroare la aggregate: pipeline must be a list,2025-06-22T18:50:58Z
